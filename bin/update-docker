#!/usr/bin/env bash

echo "starting script"

DOWNLOADS_PATH=${DOWNLOADS_PATH:-"$HOME/downloads"}

echo  "PATH: $DOWNLOADS_PATH"
ls -la $DOWNLOADS_PATH

mkdir -p $DOWNLOADS_PATH

echo "created $DOWNLOADS_PATH directory"

ls -la $DOWNLOADS_PATH

if [[ -e $DOWNLOADS_PATH/mochitest-runner.tar ]]; then
  echo "about to load!"
  time docker load -i $DOWNLOADS_PATH/mochitest-runner.tar;
  echo "loaded docker image"
fi

echo "IMAGES"
docker images

echo "PULL"
time docker pull jlongster/mochitest-runner

echo "IMAGES"
docker images

time docker save jlongster/mochitest-runner > $DOWNLOADS_PATH/mochitest-runner.tar

ls -la $DOWNLOADS_PATH

echo "saved docker image to $DOWNLOADS_PATH"
